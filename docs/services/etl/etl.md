# ETL Service

* * *

### **Задача (Бизнес требование):**
Реализация сервиса **ETL(Extract-Transform-Load)** для переноса и синхронизации данных из Postgres в ElasticSearch.

* * *

## **Описание:**
Основные данные для **Cinema Service(ElasticSearch)** формируются и добавляются через **Admin Service(Postgres)**.
В связи с этим, **ETL Service** выступает в роли промежуточного сервиса по синхронизации и актуализации данных между
вышеуказанными сервисами.


## Архитектура сервиса:
TODO:

### Компоненты:
- **Extract**:
- - Запрашивает данные из **PostgresDB**(с учетом метки **SamplingDate**), агрегирует и отправляет их в **Storage**;
- - Обновляет метку **SamplingDate**;
- - Обрабатывает падение **PostgresDB**;

- **Transform**:
- - Получает сырые данные из **Storage** пачкой;
- - Форматирует полученные данные в пригодные для сохранения в **ElasticSearchDB**;
- - Отправляет форматированные данные в **Storage**;

- **Load**:
- - Получает форматированные данные из **Storage** пачкой;
- - Обновляет полученные данные в **ElasticSearchDB**;
- - Обрабатывает падение **ElasticSearchDB**;

- **Storage**: общая шина, хранящая данные обновляемых объектов. Является объединяющим звеном основных ETL-процессов.
- **SamplingDate**: метка, хранит дату и время обновления последнего выбранного объекта.


## Основные компоненты сервиса + зоны ответственности:
### Backend:
**ETLService**:
- Обновление и синхронизация данных **CinemaElasticSearchDB** с **AdminPostgresDB**;
- Используемые решения:
TODO:

**CinemaPostgresDB**:
- Реляционная база данных для хранения и управления(администрированием) основной информации по объектам
**Cinema Service(ElasticSearch)**;
- Используемые решения:
- - PostgreSQL: https://www.postgresql.org/;

**CinemaElasticSearchDB**:
- Распределенная поисковая и аналитическая система с возможностью масштабного полнотекстового поиска
(документо-ориентированная);
- Используемые решения:
- - Elasticsearch: https://www.elastic.co/elasticsearch;


## Требования:
### Функциональные:
- Основные объекты, с которыми работает **Cinema Service(ElasticSearch)**, должны быть импортированы из
**Admin Service** (tables/relations и т.д.);
- Данные в **Cinema Service(ElasticSearch)** должны синхронизироваться со всеми правками, внесенными в объекты
**Cinema Service(ElasticSearch)**, в максимально короткий срок;

### Нефункциональные:
- **Availability**(доступность системы):
- - SLA(Service Level Agreement): 99%;
- **Reliability**(надежность системы): >= 85%;
- **Fault Tolerance**(отказоустойчивость системы):
- - Механизмы быстрого восстановления после сбоев;
- - "Умная деградация" системы в случае сбоя одного из компонентов (ElasticSearchDB, PostgresDB). Т.е. предусмотреть
механизм **"затухания"** работы с упавшим элементом системы;
- **Иное**:
- - Система должна контролировать кол-во обрабатываем ресурсов за единицу работы с учетом используемых систем
(т.е. принимать в расчет кол-во синхронизируемых объектов за цикл с учетом используемы БД);
- - В качестве метки(**SamplingDate**) по выборке объектов синхронизации использовать дату обновления объекта (что позволит
восстановить систему в случае сбоя).
